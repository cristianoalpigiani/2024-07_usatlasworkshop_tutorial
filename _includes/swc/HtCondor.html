



<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2022-08-02 21:26:21 -0500">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="http://localhost:4000/assets/favicons/swc/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="http://localhost:4000/assets/favicons/swc/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="http://localhost:4000/assets/favicons/swc/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="http://localhost:4000/assets/favicons/swc/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="http://localhost:4000/assets/favicons/swc/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="Software Carpentry - Quickstart Tutorial"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="http://localhost:4000/assets/favicons/swc/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="http://localhost:4000/assets/favicons/swc/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="http://localhost:4000/assets/favicons/swc/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="http://localhost:4000/assets/favicons/swc/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="http://localhost:4000/assets/favicons/swc/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>Quickstart Tutorial: HTCondor</title>
  </head>
  <body>

    


<div class="panel panel-default life-cycle">
  <div id="life-cycle" class="panel-body pre-alpha">
    This lesson is still being designed and assembled (Pre-Alpha version)
  </div>
</div>





    <div class="container">
      
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://software-carpentry.org" class="pull-left">
        <img class="navbar-logo" src="../assets/img/swc-icon-blue.svg" alt="Software Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="../index.html">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-uchicago/index.html">UChicago Analysis Facility</a></li>
            
            <li><a href="../02-accountrequest/index.html">Account Request & Login via SSH</a></li>
            
            <li><a href="../03-atlasenv/index.html">Atlas environment</a></li>
            
            <li><a href="../04-htcondor/index.html">HTCondor</a></li>
            
            <li><a href="../05-coffea_casa/index.html">Coffea Casa</a></li>
            
            <li><a href="../05-jupyter_lab/index.html">JupyterLab</a></li>
            
            <li><a href="../07-goodpractices/index.html">Good practices</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio/index.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../customization/index.html">Customizing Your Workshop's Website</a></li>
            
            <li><a href="../design/">Background and Design</a></li>
            
            <li><a href="../faq/index.html">FAQ</a></li>
            
            <li><a href="../helpers/index.html">Information for Helpers</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../LICENSE.html">License</a></li>
	
	<li><a href="https://github.com/eressegu/atlas-example-workflow/edit/gh-pages/_episodes/04-htcondor.md">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>


<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../03-atlasenv/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">Quickstart Tutorial</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../05-coffea_casa/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">HTCondor</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 0 min
      <br/>
      <strong>Exercises:</strong> 0 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How Do I handle jobs with HTCondor?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Learn the mean 5 steps to Run a job</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<!--- just a comment --->
<blockquote class="callout">
  <h2 id="htcondor">HTCondor</h2>

  <ul>
    <li>
      <p><a href="#intro">Introduction</a></p>
    </li>
    <li>
      <p><a href="#running">Running a job</a></p>
    </li>
    <li>
      <p><a href="#quick">HTCondor quick start</a></p>
    </li>
    <li>
      <p><a href="#submitting">Submitting a job</a></p>
    </li>
    <li>
      <p><a href="#managing">Managing a job</a></p>
    </li>
    <li>
      <p><a href="#services">Services for running jobs</a></p>
    </li>
  </ul>

</blockquote>
<!-------------------------------------------------------------------------------------->
<!----------------------------- about htcondor (introduction)--------------------------->

<h2 id="intro">Introduction</h2>

<p>HTCondor is a specialized batch system for managing compute-intensive jobs. It provides a queuing mechanism, scheduling policy, priority scheme, and resource classifications. Users submit their compute jobs to HTCondor, HTCondor puts the jobs in a queue, runs them, and then informs the user as to the result.</p>

<p>This architecture can be implemented in different ways.</p>

<table>
  <tbody>
    <tr>
      <td><img src="./../fig/onecomputer.png" alt="image info" /></td>
      <td><img src="./../fig/manycomputers.png" alt="image info" /></td>
    </tr>
  </tbody>
</table>

<!------------------------------------------------------------------------------------->
<!----------------------------- running a job ----------------------------------------->
<h2 id="running">Running a job</h2>

<blockquote class="callout">

  <ul>
    <li>
      <p>Job : an independently-scheduled unit of computing work</p>
    </li>
    <li>
      <p>Executable: script to run.</p>
    </li>
    <li>
      <p>Input:  input arguments and/or file based information.</p>
    </li>
    <li>
      <p>Output: any files or display information produced by the executable.</p>
    </li>
  </ul>

</blockquote>

<p>Work Decomposition</p>

<p><img src="./../fig/run_job_steps.png" alt="image info" /></p>

<!------------------------------------------------------------------------------------->
<!----------------------------- htcondor quick start----------------------------------->

<h2 id="quick"> HTCondor quick start </h2>

<p>HTCondor is a job scheduler, you give HTCondor a file containing commands that tell it how to run jobs. HTCondor locates a machine that can run each job within the pool of machines, packages up the job and ships it off to this execute machine, the jobs run and output is returned to the machine that submitted the jobs</p>

<p>This guides provides enough guidance to submit and observer the successful completion of a first job, it then suggests extensions that you can apply to your particular jobs</p>

<blockquote class="callout">
  <p>This guide presumes that:</p>

  <ul>
    <li>
      <p>You are logged into a working on the submit machine.</p>
    </li>
    <li>
      <p>Your program executable, your submit description file and any needed input files are all on the file system of the submit machine.</p>
    </li>
    <li>
      <p>Your job (the program executable) is able to run without any interactive input.</p>
    </li>
  </ul>

</blockquote>

<ul>
  <li>A first HTCondor job</li>
</ul>

<p>For HTCondor to run a job it must be given details such as the names and location of the exe and all needed input files in a submit description file.</p>

<p>This first executable program is a shell script. Try this example, log in to the submit machine, and use an editor to type in or copy and paste the file contents. Name the resulting file:</p>

<p><code class="language-plaintext highlighter-rouge">sleep.sh</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="c"># file name: sleep.sh</span>

<span class="nv">TIMETOWAIT</span><span class="o">=</span><span class="s2">"6"</span>
<span class="nb">echo</span> <span class="s2">"sleeping for </span><span class="nv">$TIMETOWAIT</span><span class="s2"> seconds"</span>
/bin/sleep <span class="nv">$TIMETOWAIT</span>

</code></pre></div></div>
<p>Change the sleep.sh file to be executable by running the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod </span>u+x sleep.sh
</code></pre></div></div>

<p>The submit description file describes the job. To submit this sample job, again use an editor to create the file:</p>

<p><code class="language-plaintext highlighter-rouge">sleep.sub</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># sleep.sub -- simple sleep job</span>

executable              <span class="o">=</span> sleep.sh
log                     <span class="o">=</span> sleep.log
output                  <span class="o">=</span> outfile.txt
error                   <span class="o">=</span> errors.txt
should_transfer_files   <span class="o">=</span> Yes
when_to_transfer_output <span class="o">=</span> ON_EXIT
queue
</code></pre></div></div>

<p>The first line of this submit description file is a comment. Comments begin with the # character. Comments do not span lines.</p>

<p>Each line of the submit description file has the form</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>command_name <span class="o">=</span> value
</code></pre></div></div>

<p>The command name is case insensitive and precedes an equals sign. Values to right of the equals sign are likely to be case sensitive.</p>

<p>Next in this file is a specification of the executable to run. It specifies the program that becomes the HTCondor job. For this example, it is the file name of the script. A full path and executable name, or a path and executable relative to the current working directory may be specified.</p>

<p>The log command causes a job event log file named sleep.log to be created on the submit machine once the job is submitted.</p>

<p>If this script/batch file were to be invoked from the command line, and outside of HTCondor, its single line of output</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sleeping for 6 seconds
</code></pre></div></div>
<p>would be sent to standard output. When submitted as an HTCondor job, standard output of the execute machine is on that execute machine. HTCondor captures standard output in a file due to the output command in the submit description file. This example names the redirected standard output file outfile.txt, and this file is returned to the submit machine when the job completes. The same structure is specified for standard error, as specified with the error command.</p>

<p>The commands</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>should_transfer_files   <span class="o">=</span> Yes
when_to_transfer_output <span class="o">=</span> ON_EXIT
</code></pre></div></div>
<p>direct HTCondor to explicitly send the needed files, including the executable, to the machine where the job executes. These commands will likely not be necessary for jobs in which the submit machine and the execute machine access a shared file system. However, including these commands will allow this first sample job to work under a large variety of pool configurations.</p>

<p>The queue command tells HTCondor to run one instance of this job.</p>

<ul>
  <li>Submitting the job</li>
</ul>

<p>With this submit description file, all that remains is to hand off the job to HTCondor. With the current working directory being the one that contains the sleep.sub submit description file and the executable (sleep.sh or sleep.bat), this job submission is accomplished with the command line</p>

<div class="language-bash output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_submit sleep.sub
</code></pre></div></div>

<p>If the submission is successful, the terminal will display a response that identifies the job, of the form</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Submitting job(s).
1 job(s) submitted to cluster 6.
</code></pre></div></div>

<ul>
  <li>Monitoring the job</li>
</ul>

<p>Once the job has been submitted, command line tools may help you follow along with the progress of the job. <code class="language-plaintext highlighter-rouge">The condor_q</code> command prints a listing of all the jobs currently in the queue. For example, a short time after the user Kris submits the sleep job the submit machine on a pool that has no other queued jobs, the output may appear as</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_q
-- Submitter: example.wisc.edu : &lt;128.105.14.44:56550&gt; : example.wisc.edu
 ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD
    6.0   kris            2/13 10:49   0+00:00:03 R  0   97.7 sleep.sh

1 jobs; 0 completed, 0 removed, 0 idle, 1 running, 0 held, 0 suspended
</code></pre></div></div>

<p>The queue might contain many jobs. To see only Kris’ jobs, add an option to the condor_q command that specifies to only print Kris’ jobs:</p>

<div class="language-bash output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_q <span class="nt">-submitter</span> kris
</code></pre></div></div>

<p>The first column of output from condor_q identifies the job; the identifier is composed of two integers separated by a period. The first integer is known as a cluster number, and it will be the same for each of the potentially many jobs submitted by a single invocation of condor_submit. The second integer in the identifier is known as a process ID, and it distinguishes between distinct job instances that have the same cluster number. These values start at 0.</p>

<p>Of interest in this output, the job is running, and it has used 3 seconds of time so far.</p>

<p>At job completion, the log file contains</p>

<pre class="output"><code class="language-Output">000 (006.000.000) 02/13 10:49:04 Job submitted from host: &lt;128.105.14.44:46062&gt;
...
001 (006.000.000) 02/13 10:49:24 Job executing on host: &lt;128.105.15.5:43051?PrivNet=cs.wisc.edu&gt;
...
006 (006.000.000) 02/13 10:49:30 Image size of job updated: 100000
        0  -  MemoryUsage of job (MB)
        0  -  ResidentSetSize of job (KB)
...
005 (006.000.000) 02/13 10:49:31 Job terminated.
        (1) Normal termination (return value 0)
                Usr 0 00:00:00, Sys 0 00:00:00  -  Run Remote Usage
                Usr 0 00:00:00, Sys 0 00:00:00  -  Run Local Usage
                Usr 0 00:00:00, Sys 0 00:00:00  -  Total Remote Usage
                Usr 0 00:00:00, Sys 0 00:00:00  -  Total Local Usage
        23  -  Run Bytes Sent By Job
        113  -  Run Bytes Received By Job
        23  -  Total Bytes Sent By Job
        113  -  Total Bytes Received By Job
        Partitionable Resources :    Usage  Request Allocated
           Cpus                 :                 1         1
           Disk (KB)            :   100000   100000   2033496
           Memory (MB)          :        0       98      2001
...
</code></pre>

<p>Each event in the job event log file is separated by a line containing three periods. For each event, the first 3-digit value is an event number.</p>

<ul>
  <li>Removing a job</li>
</ul>

<p>Successfully submitted jobs will occasionally need to be removed from the queue. Invoke the condor_rm command specifying the job identifier as a command line argument. Kris’ job may be removed from the queue with</p>
<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_rm 6.0
</code></pre></div></div>

<p>Specification of the cluster number only as with the command</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_rm 6
</code></pre></div></div>

<p>will cause all jobs within that cluster to be removed.</p>

<ul>
  <li>The science Job Example</li>
</ul>

<p>A <strong>second example</strong> job illustrates aspects of file specification for the job. This program does not use standard input or output; instead, the command line to invoke this program specifies two input files and one output file. For this example, the command line to invoke science.exe (not as an HTCondor job) will be</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>science.exe infile-A.txt infile-B.txt outfile.txt
</code></pre></div></div>

<p>While the name of the executable is specified in the submit description file with the executable command, the remainder of the command line will be specified with the arguments command.</p>

<p>Here is the submit description file for this job:</p>

<p><code class="language-plaintext highlighter-rouge">science1.sub</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># science1.sub -- run one instance of science.exe</span>
executable              <span class="o">=</span> science.exe
arguments               <span class="o">=</span> <span class="s2">"infile-A.txt infile-B.txt outfile.txt"</span>
transfer_input_files    <span class="o">=</span> infile-A.txt,infile-B.txt
should_transfer_files   <span class="o">=</span> IF_NEEDED
when_to_transfer_output <span class="o">=</span> ON_EXIT
log                     <span class="o">=</span> science1.log
queue
</code></pre></div></div>
<p>The input files infile-A.txt and infile-B.txt will need to be available on the execute machine within the pool where the job runs. HTCondor cannot interpret command line arguments, The submit command transfer_input_files instructs HTCondor to transfer these input files from the machine where the job is submitted to the machine chosen to execute the job. The default operation of HTCondor is to transfer all files created by the job on the execute machine back to the submit machine. Therefore, there is no specification of the outfile.txt output file.</p>

<p>This example submit description file modifies the commands that direct the transfer of files from submit machine to execute machine and back again.</p>

<div class="language-bash output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>should_transfer_files   <span class="o">=</span> IF_NEEDED
when_to_transfer_output <span class="o">=</span> ON_EXIT
</code></pre></div></div>

<p>These values are the HTCondor defaults. The should_transfer_files command specifies whether HTCondor should assume the existence of a file system shared by the submit machine and the execute machine.</p>

<p>When the job completes, all files created by the executable as it ran are transferred back to the submit machine.</p>

<ul>
  <li>Expanding the science Job and the Organization of Files</li>
</ul>

<p>A <strong>third example</strong> promotes understanding of how HTCondor makes the submission of lots of jobs easy. Assume that the science.exe job is to be run 40 times. If the input and output files were exactly the same for each run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>queue
</code></pre></div></div>
<p>to</p>

<div class="language-bash output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>queue 40
</code></pre></div></div>

<p>It is likely that this does not produce the desired outcome, as the output file created, outfile.txt, has the same name for each queued instance of the job, and thus this file of results for each run conflicts. Chances are that the input files also must be distinct for each of the 40 separate instances of the job.</p>

<p>HTCondor offers the use of a macro that can uniquely name each run’s input and output file names. The $(Process) macro causes substitution by the process ID from the job identifier. The submit description file for this proposed solution uniquely names the files:</p>

<div class="language-bash output highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># science2.sub -- run 40 instances of science.exe</span>
executable              <span class="o">=</span> science.exe
arguments               <span class="o">=</span> <span class="s2">"infile-</span><span class="si">$(</span>Process<span class="si">)</span><span class="s2">A.txt infile-</span><span class="si">$(</span>Process<span class="si">)</span><span class="s2">B.txt outfile</span><span class="si">$(</span>Process<span class="si">)</span><span class="s2">.txt"</span>
transfer_input_files    <span class="o">=</span> infile-<span class="si">$(</span>Process<span class="si">)</span>A.txt,infile-<span class="si">$(</span>Process<span class="si">)</span>B.txt
should_transfer_files   <span class="o">=</span> IF_NEEDED
when_to_transfer_output <span class="o">=</span> ON_EXIT
log                     <span class="o">=</span> science2.log
queue 40
</code></pre></div></div>

<p>The 40 instances of this job will have process ID values that run from 0 to 39. The two input files for process ID 0 are infile-0A.txt and infile-0B.txt, the ones for process ID 1 will be infile-1A.txt and infile-1B.txt, and so on, all the way to process ID 39, which will be files infile-39A.txt and infile-39B.txt. Using this macro for the output file naming of each of the 40 jobs creates outfile0.txt for process ID 0; outfile1.txt for process ID 1; and so on, to outfile39.txt for process ID 39.</p>

<p>Assume now that there will be 100 instances of the science.exe job, and each instance has distinct input files, and produces a distinct output file. A recommended organization introduces a unique directory for each job instance. The following submit description file facilitates this organization by specifying the directory with the initialdir command. The directories for this example are named run0, run1, etc. all the way to run99 for the 100 instances of the following example submit file:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># science3.sub -- run 100 instances of science.exe, with</span>
<span class="c">#  unique directories named by the $(Process) macro</span>
executable              <span class="o">=</span> science.exe
arguments               <span class="o">=</span> <span class="s2">"infile-A.txt infile-B.txt outfile.txt"</span>
should_transfer_files   <span class="o">=</span> IF_NEEDED
when_to_transfer_output <span class="o">=</span> ON_EXIT
initialdir              <span class="o">=</span> run<span class="si">$(</span>Process<span class="si">)</span>
transfer_input_files    <span class="o">=</span> infile-A.txt,infile-B.txt
log                     <span class="o">=</span> science3.log
queue 100
</code></pre></div></div>

<p>The input and output files for each job instance can again be the initial simple names that do not incorporate the $(Process) macro. These files are distinct for each run due to their placement within a uniquely named directory. This organization also works well for executables that do not facilitate command line naming of input or output files.</p>

<p>Here is a listing of the files and directories on the submit machine within this suggested directory structure. The files created due to submitting and running the jobs are shown preceded by an asterisk (*). Only a subset of the 100 directories are shown. Directories are identified using the Linux (and Mac) convention of appending the directory name with a slash character (/).</p>

<pre><code class="language-output">science.exe
science3.sub
run0/
    infile-A.txt
    infile-B.txt
    * outfile.txt
    * science3.log
run1/
    infile-A.txt
    infile-B.txt
    * outfile.txt
    * science3.log
run2/
    infile-A.txt
    infile-B.txt
    * outfile.txt
    * science3.log
</code></pre>

<!------------------------------------------------------------------------------------->
<!----------------------------- submitting a job -------------------------------------->

<h2 id="submitting"> Submitting a Job</h2>

<p>The <code class="language-plaintext highlighter-rouge">condor_submit</code> command takes a job description file as input and submits the job to HTCondor.  Items such as the name of the executable to run, the initial working directory, and command-line arguments to the program all go into the submit description file. <code class="language-plaintext highlighter-rouge">condor_submit</code> creates a job ClassAd based upon the information, and HTCondor works toward running the job.</p>

<ul>
  <li>
    <p>Sample submit description files</p>

    <ul>
      <li>Example 1</li>
    </ul>
  </li>
</ul>

<p>This example is one of the simplest submit description files possible. It queues the program myexe for execution somewhere in the pool. As this submit description file does not request a specific operating system to run on, HTCondor will use the default, which is to run the job on a machine which has the same architecture and operating system it was submitted from.</p>

<p>Before submitting a job to HTCondor, it is a good idea to test it first locally, by running it from a command shell. This example job might look like this when run from the shell prompt.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./myexe SomeArgument
</code></pre></div></div>
<p>The corresponding submit description file might look like the following</p>

<p><code class="language-plaintext highlighter-rouge">example1.sub</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example 1</span>
<span class="c"># Simple HTCondor submit description file</span>
<span class="c"># Everything with a leading # is a comment</span>

executable   <span class="o">=</span> myexe
arguments    <span class="o">=</span> SomeArgument

output       <span class="o">=</span> outputfile   
error        <span class="o">=</span> errorfile
log          <span class="o">=</span> myexe.log

request_cpus   <span class="o">=</span> 1
request_memory <span class="o">=</span> 1024
request_disk   <span class="o">=</span> 10240

should_transfer_files <span class="o">=</span> <span class="nb">yes

</span>queue
</code></pre></div></div>

<blockquote class="callout">
  <ul>
    <li>Explanation of variables in example 1:</li>
  </ul>

  <p>output        :   The standard output for this job will go to the file <code class="language-plaintext highlighter-rouge">outputfile</code>.</p>

  <p>error :  The standard error output will go to <code class="language-plaintext highlighter-rouge">errorfile</code>.</p>

  <p>log :    Appended evenst about the job to the log file named <code class="language-plaintext highlighter-rouge">myexe.log</code>.</p>

  <p>request_cpus  :   The job should be allocated 1 cpu core.</p>

  <p>request_memory:   1024 megabytes of memory.</p>

  <p>request_disk  :   10240 kilobytes of scratch disk space.</p>

  <p>queue         :   Hey HTCondor! I’ve finished the description of the job, send it to the queue.</p>

</blockquote>

<ul>
  <li>Example 2</li>
</ul>

<p>A simple example</p>

<p><code class="language-plaintext highlighter-rouge">example2.sub</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example 2: Show off some fancy features,</span>
<span class="c"># including the use of pre-defined macros.</span>

executable     <span class="o">=</span> foo
arguments      <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>

request_memory <span class="o">=</span> 4096
request_cpus   <span class="o">=</span> 1
request_disk   <span class="o">=</span> 16383

error   <span class="o">=</span> err.<span class="si">$(</span>Process<span class="si">)</span>
output  <span class="o">=</span> out.<span class="si">$(</span>Process<span class="si">)</span>
log     <span class="o">=</span> foo.log

should_transfer_files <span class="o">=</span> <span class="nb">yes
</span>transfer_input_files <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>

<span class="c"># submit 150 instances of this job</span>
queue 150
</code></pre></div></div>

<p>Each instance of this program works on one input file. 
We prepare 150 copies of this input file in the current directoy, and name them input_file.0, … up to input_file.149. 
Whit transfer_input_files, we tell HTCondor which input file to send to each instance of the program.</p>

<ul>
  <li>Example 3</li>
</ul>

<p>A simple example with a python script</p>

<p>We write our executable in the file:</p>

<p><code class="language-plaintext highlighter-rouge">hello.py</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env python</span>
import sys
import <span class="nb">time
</span><span class="nv">i</span><span class="o">=</span>1
<span class="k">while </span>i&lt;<span class="o">=</span>6:
        print i
        i+<span class="o">=</span>1
        time.sleep<span class="o">(</span>1<span class="o">)</span>
print 2<span class="k">**</span>8
print <span class="s2">"hello world received argument = "</span> +sys.argv[1]
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python hello.py
</code></pre></div></div>
<p>Create the directory:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>output
</code></pre></div></div>

<p>Now we need or submit file:</p>

<p>hello.sub</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Universe        <span class="o">=</span> vanilla
Executable      <span class="o">=</span> hello.py
Output          <span class="o">=</span> output/hello.out.<span class="si">$(</span>Cluster<span class="si">)</span>.<span class="si">$(</span>Process<span class="si">)</span>.txt
Error           <span class="o">=</span> output/hello.error.<span class="si">$(</span>Cluster<span class="si">)</span>.<span class="si">$(</span>Process<span class="si">)</span>.txt
Log             <span class="o">=</span> output/hello.log.<span class="si">$(</span>Cluster<span class="si">)</span>.<span class="si">$(</span>Process<span class="si">)</span>.txt
notification <span class="o">=</span> Never
Arguments <span class="o">=</span> <span class="si">$(</span>Process<span class="si">)</span>
PeriodicRelease <span class="o">=</span> <span class="o">((</span><span class="nv">JobStatus</span><span class="o">==</span>5<span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span>CurentTime - EnteredCurrentStatus<span class="o">)</span> <span class="o">&gt;</span> 30<span class="o">)</span>
OnExitRemove <span class="o">=</span> <span class="o">(</span>ExitStatus <span class="o">==</span> 0<span class="o">)</span>
Queue 4
</code></pre></div></div>

<p>submit out job</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_submit hello.sub
</code></pre></div></div>

<p>check status:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_q
</code></pre></div></div>

<ul>
  <li>Example 4</li>
</ul>

<p>A simple example with a small program in C.</p>

<p>Let’s start creating a directory for this example</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>simple_c
<span class="nb">cd </span>simple_c
</code></pre></div></div>

<p>Write your executable in the file:</p>

<p><code class="language-plaintext highlighter-rouge">simple.c</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#include &lt;stdio.h&gt;</span>

main<span class="o">(</span>int argc, char <span class="k">**</span>argv<span class="o">)</span>
<span class="o">{</span>
    int sleep_time<span class="p">;</span>
    int input<span class="p">;</span>
    int failure<span class="p">;</span>

    <span class="k">if</span> <span class="o">(</span>argc <span class="o">!=</span> 3<span class="o">)</span> <span class="o">{</span>
        <span class="nb">printf</span><span class="o">(</span><span class="s2">"Usage: simple &lt;sleep-time&gt; &lt;integer&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="o">)</span><span class="p">;</span>
        failure <span class="o">=</span> 1<span class="p">;</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        sleep_time <span class="o">=</span> atoi<span class="o">(</span>argv[1]<span class="o">)</span><span class="p">;</span>
        input      <span class="o">=</span> atoi<span class="o">(</span>argv[2]<span class="o">)</span><span class="p">;</span>

        <span class="nb">printf</span><span class="o">(</span><span class="s2">"Thinking really hard for %d seconds...</span><span class="se">\n</span><span class="s2">"</span>, sleep_time<span class="o">)</span><span class="p">;</span>
        <span class="nb">sleep</span><span class="o">(</span>sleep_time<span class="o">)</span><span class="p">;</span>
        <span class="nb">printf</span><span class="o">(</span><span class="s2">"We calculated: %d</span><span class="se">\n</span><span class="s2">"</span>, input <span class="k">*</span> 2<span class="o">)</span><span class="p">;</span>
        failure <span class="o">=</span> 0<span class="p">;</span>
    <span class="o">}</span>
    <span class="k">return </span>failure<span class="p">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>compile the program</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcc <span class="nt">-o</span> simple simple.c
</code></pre></div></div>

<p>Now run the program and tell it to sleep for four seconds and calculate 10 * 2:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./simple 4 10
</code></pre></div></div>
<p>output</p>
<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Thinking really hard for 4 seconds...
We calculated: 20
</code></pre></div></div>

<p>Submitting the job</p>

<p><code class="language-plaintext highlighter-rouge">simple.sub</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Universe   <span class="o">=</span> vanilla
Executable <span class="o">=</span> simple
Arguments  <span class="o">=</span> 4 10
Log        <span class="o">=</span> simple.log
Output     <span class="o">=</span> simple.out
Error      <span class="o">=</span> simple.error
Queue
</code></pre></div></div>
<p>Ask HTCondor to run the job</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_submit simple.sub
</code></pre></div></div>
<p>Output</p>
<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Submitting job(s)con.
Logging submit event(s).
1 job(s) submitted to cluster 6075
</code></pre></div></div>

<p>watch the job run</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_q

-- Submitter: ws-03.gs.unina.it : &lt;192.167.2.23:34353&gt; : ws-03.gs.unina.it
 ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD               
   2.0   temp-01         3/15 16:27   0+00:00:00 I  0   0.0  simple 4 10       

1 jobs; 1 idle, 0 running, 0 held

% condor_q

-- Submitter: ws-03.gs.unina.it : &lt;192.167.2.23:34353&gt; : ws-03.gs.unina.it
 ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD               
   2.0   temp-01         3/15 16:27   0+00:00:01 R  0   0.0  simple 4 10       

1 jobs; 0 idle, 1 running, 0 held

% condor_q


-- Submitter: ws-03.gs.unina.it : &lt;192.167.2.23:34353&gt; : ws-03.gs.unina.it
 ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD               

0 jobs; 0 idle, 0 running, 0 held
</code></pre></div></div>

<ul>
  <li>Using parameters in the simple job</li>
</ul>

<p>If we would like to have our program calculate a whole set of values for different inputs. How can we do that?</p>

<p><code class="language-plaintext highlighter-rouge">simple_set.sub</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Universe   <span class="o">=</span> vanilla
Executable <span class="o">=</span> simple
Arguments  <span class="o">=</span> 4 10
Log        <span class="o">=</span> simple_set.log
Output     <span class="o">=</span> simple_set.<span class="si">$(</span>Process<span class="si">)</span>.out
Error      <span class="o">=</span> simple_set.<span class="si">$(</span>Process<span class="si">)</span>.error
Queue

Arguments <span class="o">=</span> 4 11
Queue

Arguments <span class="o">=</span> 4 12
Queue
</code></pre></div></div>

<p>Now see what happens when we ask HTCondor to run the job and check the status</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%  condor_submit submit
Submitting job(s)...
Logging submit event(s)...
3 job(s) submitted to cluster 2.

% condor_q 

-- Submitter: roy@ws-03.gs.unina.it : &lt;192.167.2.23:32787&gt; : ws-03.gs.unina.it
 ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD               
   2.0   roy             1/25 12:28   0+00:00:00 R  0   0.0  simple 4 10       
   2.1   roy             1/25 12:28   0+00:00:00 R  0   0.0  simple 4 11       
   2.2   roy             1/25 12:28   0+00:00:00 R  0   0.0  simple 4 12       

3 jobs; 0 idle, 3 running, 0 held

% condor_q 


-- Submitter: roy@ws-03.gs.unina.it : &lt;128.105.48.160:32787&gt; : ws-03.gs.unina.it
 ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD               

0 jobs; 0 idle, 0 running, 0 held

% ls simple*out
simple.0.out  simple.1.out  simple.2.out  simple.out

% cat simple.0.out
Thinking really hard for 4 seconds...
We calculated: 20

% cat simple.1.out
Thinking really hard for 4 seconds...
We calculated: 22

% cat simple.2.out
Thinking really hard for 4 seconds...
We calculated: 24
</code></pre></div></div>

<ul>
  <li>Submitting many similar jobs with one queue command</li>
</ul>

<p>A wide variety of job submissions can be specified with extra information to the queue submit command. This flexibility eliminates the need for a job wrapper or Perl script for many submissions.</p>

<p>The form of the queue command defines variables and expands values, identifying a set of jobs. Square brackets identify an optional item.</p>

<p>queue [ &lt; int expr &gt; ]</p>

<p>queue [ &lt; int expr &gt; ] [ &lt; varname &gt; ] in [ slice ] &lt; list of items &gt;</p>

<p>queue [ &lt; int expr &gt; ] [ &lt; varname &gt; ] matching [ files  l  dirs ] [ slice ] &lt; list of items with file globbing &gt;</p>

<p>queue [ &lt; int expr &gt; ] [ &lt; list of varnames &gt; ] from [ slice ] &lt; file name &gt;  l  &lt; list of items &gt;</p>

<p>All optional items have defaults:</p>

<ul>
  <li>
    <p>If &lt; int expr &gt; is not specified, it defaults to the value 1.</p>
  </li>
  <li>
    <p>If &lt; varname &gt; or &lt; list of varnames &gt; is not specified, it defaults to the single variable called ITEM.</p>
  </li>
  <li>
    <p>If slice is not specified, it defaults to all elements within the list. This is the Python slice [::], with a step value of 1.</p>
  </li>
  <li>
    <p>If neither files nor dirs is specified in a specification using the from key word, then both files and directories are considered when globbing.</p>
  </li>
</ul>

<p>The optional slice specifies a subset of the list of items using the Python syntax for a slice. Negative step values are not permitted.</p>

<p>Here are a set of examples.</p>

<ul>
  <li>Example 1</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>transfer_input_files <span class="o">=</span> <span class="si">$(</span>filename<span class="si">)</span>
arguments            <span class="o">=</span> <span class="nt">-infile</span> <span class="si">$(</span>filename<span class="si">)</span>
queue filename matching files <span class="k">*</span>.dat
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>transfer_input_files <span class="o">=</span> initial.dat
arguments            <span class="o">=</span> <span class="nt">-infile</span> initial.dat
queue
transfer_input_files <span class="o">=</span> middle.dat
arguments            <span class="o">=</span> <span class="nt">-infile</span> middle.dat
queue
transfer_input_files <span class="o">=</span> ending.dat
arguments            <span class="o">=</span> <span class="nt">-infile</span> ending.dat
queue
</code></pre></div></div>

<ul>
  <li>Example 2</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>queue 1 input <span class="k">in </span>A, B, C
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>input <span class="o">=</span> A
queue
input <span class="o">=</span> B
queue
input <span class="o">=</span> C
queue
</code></pre></div></div>

<ul>
  <li>Example 3</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>queue input, arguments from <span class="o">(</span>
  file1, <span class="nt">-a</span> <span class="nt">-b</span> 26
  file2, <span class="nt">-c</span> <span class="nt">-d</span> 92
<span class="o">)</span>
</code></pre></div></div>
<p>Each of the two variables specified is given a value from the list of items. For this example the queue command expands to</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>input <span class="o">=</span> file1
arguments <span class="o">=</span> <span class="nt">-a</span> <span class="nt">-b</span> 26
queue
input <span class="o">=</span> file2
arguments <span class="o">=</span> <span class="nt">-c</span> <span class="nt">-d</span> 92
queue
</code></pre></div></div>

<ul>
  <li>Example 4</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>queue from <span class="nb">seq </span>7 9 |
</code></pre></div></div>

<p>feeds the list of items to queue with the output of seq 7 9:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>item <span class="o">=</span> 7
queue
item <span class="o">=</span> 8
queue
item <span class="o">=</span> 9
queue
</code></pre></div></div>
<ul>
  <li>Variables in the Submit Description File</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">$(Cluster) or $(ClusterId)</code></p>

<p><code class="language-plaintext highlighter-rouge">$(Process) or $(ProcId)</code></p>

<p><code class="language-plaintext highlighter-rouge">$$(a_machine_classad_attribute)</code></p>

<p><code class="language-plaintext highlighter-rouge">$$([ an_evaluated_classad_expression ])</code></p>

<p><code class="language-plaintext highlighter-rouge">$(ARCH)</code></p>

<p><code class="language-plaintext highlighter-rouge">$(OPSYS) $(OPSYSVER) $(OPSYSANDVER) $(OPSYSMAJORVER)</code></p>

<p><code class="language-plaintext highlighter-rouge">$(SUBMIT_FILE)</code></p>

<p><code class="language-plaintext highlighter-rouge">$(SUBMIT_TIME)</code></p>

<p><code class="language-plaintext highlighter-rouge">$(Year) $(Month) $(Day)</code></p>

<p><code class="language-plaintext highlighter-rouge">$(Item)</code></p>

<p><code class="language-plaintext highlighter-rouge">$(ItemIndex)</code></p>

<p><code class="language-plaintext highlighter-rouge">$(Step)</code></p>

<p><code class="language-plaintext highlighter-rouge">$(Row)</code></p>

<ul>
  <li>Including Submit Commands Defined Elsewhere</li>
</ul>

<p>Externally defined submit commands can be incorporated into the submit description file using the syntax</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>include : &lt;what-to-include&gt;
</code></pre></div></div>

<p>The <what-to-include> specification may specify a single file, where the contents of the file will be incorporated into the submit description file at the point within the file where the include is. Or, <what-to-include> may cause a program to be executed, where the output of the program is incorporated into the submit description file. The specification of <what-to-include> has the bar character (|) following the name of the program to be executed.</what-to-include></what-to-include></what-to-include></p>

<p>Consider the example</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>include : ./list-infiles.sh |
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>

<span class="nb">echo</span> <span class="s2">"transfer_input_files = </span><span class="sb">`</span><span class="nb">ls</span> <span class="nt">-m</span> infiles/<span class="k">*</span>.dat<span class="sb">`</span><span class="s2">"</span>
<span class="nb">exit </span>0
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>transfer_input_files <span class="o">=</span> infiles/A.dat, infiles/B.dat, infiles/C.dat
</code></pre></div></div>

<p>is incorporated into the submit description file.</p>

<ul>
  <li>Using Conditionals in the Submit Description File</li>
</ul>

<p>Conditional if/else semantics are available in a limited form. The syntax:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> &lt;simple condition&gt;
   &lt;statement&gt;
   <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
   &lt;statement&gt;
<span class="k">else</span>
   &lt;statement&gt;
   <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
   &lt;statement&gt;
endif
</code></pre></div></div>

<p>An else key word and statements are not required, such that simple if semantics are implemented. The <simple condition=""> does not permit compound conditions. It optionally contains the exclamation point character (!) to represent the not operation, followed by</simple></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">if </span>defined MY_UNDEFINED_VARIABLE
       X <span class="o">=</span> 12
    <span class="k">else
       </span>X <span class="o">=</span> <span class="nt">-1</span>
    endif
</code></pre></div></div>

<p>results in X = -1, when MY_UNDEFINED_VARIABLE is not yet defined.</p>

<ul>
  <li>
    <p>the version keyword, representing the version number of of the daemon or tool currently reading this conditional. This keyword is followed by an HTCondor version number. That version number can be of the form x.y.z or x.y. The version of the daemon or tool is compared to the specified version number. The comparison operators are</p>

    <ul>
      <li>
        <p><code class="language-plaintext highlighter-rouge">==</code> for equality. Current version 8.2.3 is equal to 8.2.</p>
      </li>
      <li>
        <p><code class="language-plaintext highlighter-rouge">&gt;=</code> to see if the current version number is greater than or equal to. Current version 8.2.3 is greater than 8.2.2, and current version 8.2.3 is greater than or equal to 8.2.</p>
      </li>
      <li>
        <p>`&lt;=  to see if the current version number is less than or equal to. Current version 8.2.0 is less than 8.2.2, and current version 8.2.3 is less than or equal to 8.2.</p>
      </li>
    </ul>

    <p>As an example,</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">if </span>version <span class="o">&gt;=</span> 8.1.6
     DO_X <span class="o">=</span> True
  <span class="k">else
     </span>DO_Y <span class="o">=</span> True
  endif
</code></pre></div>    </div>

    <ul>
      <li>
        <p>True or yes or the value 1. The statement(s) are incorporated.</p>
      </li>
      <li>
        <p>False or no or the value 0 The statement(s) are not incorporated.</p>
      </li>
    </ul>
  </li>
</ul>

<p>This sintax</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> &lt;simple condition&gt;
   &lt;statement&gt;
   <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
   &lt;statement&gt;
<span class="k">elif</span> &lt;simple condition&gt;
   &lt;statement&gt;
   <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
   &lt;statement&gt;
endif
</code></pre></div></div>

<p>is the same as syntax</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> &lt;simple condition&gt;
   &lt;statement&gt;
   <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
   &lt;statement&gt;
<span class="k">else
   if</span> &lt;simple condition&gt;
      &lt;statement&gt;
      <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
      &lt;statement&gt;
   endif
endif
</code></pre></div></div>

<p>Example</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if </span>defined X
  arguments <span class="o">=</span> <span class="nt">-n</span> <span class="si">$(</span>X<span class="si">)</span>
<span class="k">else
  </span>arguments <span class="o">=</span> <span class="nt">-n</span> 1 <span class="nt">-debug</span>
endif
</code></pre></div></div>

<p>Submit variable X is defined on the condor_submit command line with</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_submit  <span class="nv">X</span><span class="o">=</span>3  sample.sub
</code></pre></div></div>

<p>This command line incorporates the submit command X = 3 into the submission before parsing the submit description file. For this submission, the command line arguments of the submitted job become</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arguments <span class="o">=</span> <span class="nt">-n</span> 3
</code></pre></div></div>

<p>If the job were instead submitted with the command line</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_submit  sample.sub
</code></pre></div></div>

<p>then the command line arguments of the submitted job become</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arguments <span class="o">=</span> <span class="nt">-n</span> 1 <span class="nt">-debug</span>
</code></pre></div></div>

<ul>
  <li>Interactive Jobs</li>
</ul>

<p>An interactive job is a Condor job that is provisioned and scheduled like any other vanilla universe Condor job onto an execute machine within the pool. The result of a running interactive job is a shell prompt issued on the execute machine where the job runs.</p>

<p>Neither the submit nor the execute host for interactive jobs may be on Windows platforms.</p>

<p>The current working directory of the shell will be the initial working directory of the running job. The shell type will be the default for the user that submits the job. At the shell prompt, X11 forwarding is enabled.</p>

<p>Each interactive job will have a job ClassAd attribute of</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>InteractiveJob <span class="o">=</span> True
</code></pre></div></div>

<p>Submission of an interactive job specifies the option -interactive on the condor_submit command line.</p>

<p>A submit description file may be specified for this interactive job. Within this submit description file, a specification of these 5 commands will be either ignored or altered:</p>

<ol>
  <li>
    <p>executable</p>
  </li>
  <li>
    <p>transfer_executable</p>
  </li>
  <li>
    <p>arguments</p>
  </li>
  <li>
    <p>universe . The interactive job is a vanilla universe job.</p>
  </li>
  <li>
    <p>queue <n>. In this case the value of <n> is ignored; exactly one interactive job is queued.</n></n></p>
  </li>
</ol>

<p>The submit description file may specify anything else needed for the interactive job, such as files to transfer.</p>

<p>If no submit description file is specified for the job, a default one is utilized as identified by the value of the configuration variable INTERACTIVE_SUBMIT_FILE .</p>

<p>Here are examples of situations where interactive jobs may be of benefit.</p>

<ul>
  <li>
    <p>An application that cannot be batch processed might be run as an interactive job. Where input or output cannot be captured in a file and the executable may not be modified, the interactive nature of the job may still be run on a pool machine, and within the purview of Condor.</p>
  </li>
  <li>
    <p>A pool machine with specialized hardware that requires interactive handling can be scheduled with an interactive job that utilizes the hardware.</p>
  </li>
  <li>
    <p>The debugging and set up of complex jobs or environments may benefit from an interactive session. This interactive session provides the opportunity to run scripts or applications, and as errors are identified, they can be corrected on the spot.</p>
  </li>
  <li>
    <p>Development may have an interactive nature, and proceed more quickly when done on a pool machine. It may also be that the development platforms required reside within Condor’s purview as execute hosts.</p>
  </li>
  <li>
    <p>Submitting Lots of Jobs</p>
  </li>
</ul>

<p>When submitting a lot of jobs with a single submit file, you can dramatically speed up submission and reduce the load on the condor_schedd by submitting the jobs as a late materialization job factory.</p>

<p>A submission of this form sends a single ClassAd, called the Cluster ad, to the condor_schedd, as well as instructions to create the individual jobs as variations on that Cluster ad. These instructions are sent as a submit digest and optional itemdata. The submit digest is the submit file stripped down to just the statements that vary between jobs. The itemdata is the arguments to the Queue statement when the arguments are more than just a count of jobs.</p>

<p>The condor_schedd will use the submit digest and the itemdata to create the individual job ClassAds when they are needed. Materialization is controlled by two values stored in the Cluster classad, and by optional limits configured in the condor_schedd.</p>

<p>The max_idle limit specifies the maximum number of non-running jobs that should be materialized in the condor_schedd at any one time. One or more jobs will materialize whenever a job enters the Run state and the number of non-running jobs that are still in the condor_schedd is less than this limit. This limit is stored in the Cluster ad in the JobMaterializeMaxIdle attribute.</p>

<p>The max_materialize limit specifies an overall limit on the number of jobs that can be materialized in the condor_schedd at any one time. One or more jobs will materialize when a job leaves the condor_schedd and the number of materialized jobs remaining is less than this limit. This limit is stored in the Cluster ad in the JobMaterializeLimit attribute.</p>

<p>Late materialization can be used as a way for a user to submit millions of jobs without hitting the MAX_JOBS_PER_OWNER or MAX_JOBS_PER_SUBMISSION limits in the condor_schedd, since the condor_schedd will enforce these limits by applying them to the max_materialize and max_idle values specified in the Cluster ad.</p>

<p>To give an example, the following submit file:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>executable     <span class="o">=</span> foo
arguments      <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>

request_memory <span class="o">=</span> 4096
request_cpus   <span class="o">=</span> 1
request_disk   <span class="o">=</span> 16383

error   <span class="o">=</span> err.<span class="si">$(</span>Process<span class="si">)</span>
output  <span class="o">=</span> out.<span class="si">$(</span>Process<span class="si">)</span>
log     <span class="o">=</span> foo.log

should_transfer_files <span class="o">=</span> <span class="nb">yes
</span>transfer_input_files <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>

<span class="c"># submit as a factory with an idle jobs limit</span>
max_idle <span class="o">=</span> 100

<span class="c"># submit 15,000 instances of this job</span>
queue 15<span class="k">*</span>1000
</code></pre></div></div>

<p>When submitted as a late materialization factory, the submit digest for this factory will contain only the submit statments that vary between jobs, and the collapsed queue statement like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arguments <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>
error <span class="o">=</span> err.<span class="si">$(</span>Process<span class="si">)</span>
output <span class="o">=</span> out.<span class="si">$(</span>Process<span class="si">)</span>
transfer_input_files <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>

queue 15000
</code></pre></div></div>

<!------------------------------------------------------------------------------------->
<!----------------------------- managing a job ---------------------------------------->

<h2 id="managing">Managing a job</h2>

<p>What to do once jobs are submitted?</p>

<ul>
  <li>Checking on the progress of jobs</li>
</ul>

<p>You can check on your jobs with the condor_q command.</p>

<p>condor_q</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-- Schedd: submit.chtc.wisc.edu : &lt;127.0.0.1:9618?... @ 12/31/69 23:00:00
OWNER    BATCH_NAME    SUBMITTED   DONE   RUN    IDLE   HOLD  TOTAL JOB_IDS
nemo     batch23       4/22 20:44      _      _      _      1      _ 3671850.0
nemo     batch24       4/22 20:56      _      _      _      1      _ 3673477.0
nemo     batch25       4/22 20:57      _      _      _      1      _ 3673728.0
nemo     batch26       4/23 10:44      _      _      _      1      _ 3750339.0
nemo     batch27       7/2  15:11      _      _      _      _      _ 7594591.0
nemo     batch28       7/10 03:22   4428      3      _      _   4434 7801943.0 ... 7858552.0
nemo     batch29       7/14 14:18   5074   1182     30     19  80064 7859129.0 ... 7885217.0
nemo     batch30       7/14 14:18   5172   1088     28     30  58310 7859106.0 ... 7885192.0

2388 jobs; 0 completed, 1 removed, 58 idle, 2276 running, 53 held, 0 suspended
</code></pre></div></div>

<p>Often, when you are starting out, and have few jobs, you may want to see one line of output per job. The -nobatch option to condor_q does this, and output might look something like:</p>

<p>condor_q -nobatch</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-- Schedd submit.chtc.wisc.edu : &lt;127.0.0.1:9618?...
ID          OWNER        SUBMITTED     RUN_TIME ST PRI SIZE CMD
1297254.0   nemo         5/31 18:05  14+17:40:01 R  0   7.3  condor_dagman
1297255.0   nemo         5/31 18:05  14+17:39:55 R  0   7.3  condor_dagman
1297256.0   nemo         5/31 18:05  14+17:39:55 R  0   7.3  condor_dagman
1297259.0   nemo         5/31 18:05  14+17:39:55 R  0   7.3  condor_dagman
1297261.0   nemo         5/31 18:05  14+17:39:55 R  0   7.3  condor_dagman
1302278.0   nemo         6/4  12:22   1+00:05:37 I  0   390.6 mdrun_1.sh
1304740.0   nemo         6/5  00:14   1+00:03:43 I  0   390.6 mdrun_1.sh
1304967.0   nemo         6/5  05:08   0+00:00:00 I  0   0.0  mdrun_1.sh

14 jobs; 4 idle, 8 running, 2 held
</code></pre></div></div>

<p>The output contains many columns of information about the queued jobs. The ST column (for status) shows the status of current jobs in the queue:</p>

<ul>
  <li>R: The job is currently running.</li>
  <li>I: The job is idle. It is not running right now, because it is waiting for a machine to become available.</li>
  <li>H: The job is the hold state. In the hold state, the job will not be scheduled to run until it is released. See the condor_hold and the condor_release manual pages.</li>
</ul>

<p>Another useful method of tracking the progress of jobs is through the job event log.</p>

<p>When a job begins to run, HTCondor starts up a condor_shadow process on the submit machine.</p>

<p>You can also find all the machines that are running your job through the condor_status command. For example, to find all the machines that are running jobs submitted by breach@cs.wisc.edu, type:</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_status -constraint 'RemoteUser == "breach@cs.wisc.edu"'

Name       Arch     OpSys        State      Activity   LoadAv Mem  ActvtyTime

alfred.cs. INTEL    LINUX        Claimed    Busy       0.980  64    0+07:10:02
biron.cs.w INTEL    LINUX        Claimed    Busy       1.000  128   0+01:10:00
cambridge. INTEL    LINUX        Claimed    Busy       0.988  64    0+00:15:00
falcons.cs INTEL    LINUX        Claimed    Busy       0.996  32    0+02:05:03
happy.cs.w INTEL    LINUX        Claimed    Busy       0.988  128   0+03:05:00
istat03.st INTEL    LINUX        Claimed    Busy       0.883  64    0+06:45:01
istat04.st INTEL    LINUX        Claimed    Busy       0.988  64    0+00:10:00
istat09.st INTEL    LINUX        Claimed    Busy       0.301  64    0+03:45:00
...
</code></pre></div></div>
<p>To find all the machines that are running any job at all, type:</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_status -run

Name       Arch     OpSys        LoadAv RemoteUser           ClientMachine

adriana.cs INTEL    LINUX        0.980  hepcon@cs.wisc.edu   chevre.cs.wisc.
alfred.cs. INTEL    LINUX        0.980  breach@cs.wisc.edu   neufchatel.cs.w
amul.cs.wi X86_64   LINUX        1.000  nice-user.condor@cs. chevre.cs.wisc.
anfrom.cs. X86_64   LINUX        1.023  ashoks@jules.ncsa.ui jules.ncsa.uiuc
anthrax.cs INTEL    LINUX        0.285  hepcon@cs.wisc.edu   chevre.cs.wisc.
astro.cs.w INTEL    LINUX        1.000  nice-user.condor@cs. chevre.cs.wisc.
aura.cs.wi X86_64   WINDOWS      0.996  nice-user.condor@cs. chevre.cs.wisc.
balder.cs. INTEL    WINDOWS      1.000  nice-user.condor@cs. chevre.cs.wisc.
bamba.cs.w INTEL    LINUX        1.574  dmarino@cs.wisc.edu  riola.cs.wisc.e
bardolph.c INTEL    LINUX        1.000  nice-user.condor@cs. chevre.cs.wisc.
...
</code></pre></div></div>

<ul>
  <li>Peeking in on a running job’s output files</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">The condor_tail</code> command can copy output files from a running job on a remote machine back to the submit machine. condor_tail uses the same networking stack as HTCondor proper, so it will work if the execute machine is behind a firewall.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_tail <span class="nt">-f</span> xx.yy
</code></pre></div></div>
<p>To copy a different file, run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_tail xx.yy name_of_output_file
</code></pre></div></div>

<ul>
  <li>Removing a job from a queue</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">condor_rm</code></p>

<div class="language-bash output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_q <span class="nt">-nobatch</span>

<span class="nt">--</span> Schedd: froth.cs.wisc.edu : &lt;128.105.73.44:33847&gt; : froth.cs.wisc.edu
 ID      OWNER            SUBMITTED    CPU_USAGE ST PRI SIZE CMD
 125.0   raman           4/11 14:37   0+00:00:00 R  0   1.4  sleepy
 132.0   raman           4/11 16:57   0+00:00:00 R  0   1.4  hello

2 <span class="nb">jobs</span><span class="p">;</span> 1 idle, 1 running, 0 held

condor_rm 132.0
Job 132.0 removed.

condor_q <span class="nt">-nobatch</span>

<span class="nt">--</span> Schedd: froth.cs.wisc.edu : &lt;128.105.73.44:33847&gt; : froth.cs.wisc.edu
 ID      OWNER            SUBMITTED    CPU_USAGE ST PRI SIZE CMD
 125.0   raman           4/11 14:37   0+00:00:00 R  0   1.4  sleepy

1 <span class="nb">jobs</span><span class="p">;</span> 1 idle, 0 running, 0 held
</code></pre></div></div>

<ul>
  <li>Placing a job on hold</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">condor_hold</code>
<code class="language-plaintext highlighter-rouge">condor_release</code></p>

<p>Jobs that are running when placed on hold will start over from the beginning when released.</p>

<ul>
  <li>Changing the priority of jobs</li>
</ul>

<p>HTCondor provides each user with the capability of assigning priorities to each submitted job.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_q <span class="nt">-nobatch</span> raman

<span class="nt">--</span> Submitter: froth.cs.wisc.edu : &lt;128.105.73.44:33847&gt; : froth.cs.wisc.edu
 ID      OWNER            SUBMITTED    CPU_USAGE ST PRI SIZE CMD
 126.0   raman           4/11 15:06   0+00:00:00 I  0   0.3  hello

1 <span class="nb">jobs</span><span class="p">;</span> 1 idle, 0 running, 0 held

condor_prio <span class="nt">-p</span> <span class="nt">-15</span> 126.0

condor_q <span class="nt">-nobatch</span> raman

<span class="nt">--</span> Submitter: froth.cs.wisc.edu : &lt;128.105.73.44:33847&gt; : froth.cs.wisc.edu
 ID      OWNER            SUBMITTED    CPU_USAGE ST PRI SIZE CMD
 126.0   raman           4/11 15:06   0+00:00:00 I  <span class="nt">-15</span> 0.3  hello

1 <span class="nb">jobs</span><span class="p">;</span> 1 idle, 0 running, 0 held
</code></pre></div></div>

<p>It is important to note that these job priorities are completely different from the user priorities assigned by HTCondor.</p>

<ul>
  <li>Why is the job not running?</li>
</ul>

<p>The most common reason why the job is not running is that HTCondor has not yet been through its periodic negotiation cycle, in which queued jobs are assigned to machines within the pool and begin their execution.</p>

<p>‘-analyze` option of the condor_q command. Here is an example;</p>

<div class="language-bash output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_q <span class="nt">-analyze</span> 27497829

<span class="nt">--</span> Submitter: s1.chtc.wisc.edu : &lt;128.104.100.43:9618?sock<span class="o">=</span>5557_e660_3&gt; : s1.chtc.wisc.edu
User priority <span class="k">for </span>ei@chtc.wisc.edu is not available, attempting to analyze without it.
<span class="nt">---</span>
27497829.000:  Run analysis summary.  Of 5257 machines,
   5257 are rejected by your job<span class="s1">'s requirements
      0 reject your job because of their own requirements
      0 match and are already running your jobs
      0 match but are serving other users
      0 are available to run your job
        No successful match recorded.
        Last failed match: Tue Jun 18 14:36:25 2013

        Reason for last match failure: no match found

WARNING:  Be advised:
   No resources matched request'</span>s constraints

The Requirements expression <span class="k">for </span>your job is:

    <span class="o">(</span> OpSys <span class="o">==</span> <span class="s2">"OSX"</span> <span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span> TARGET.Arch <span class="o">==</span> <span class="s2">"X86_64"</span> <span class="o">)</span> <span class="o">&amp;&amp;</span>
    <span class="o">(</span> TARGET.Disk <span class="o">&gt;=</span> RequestDisk <span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span> TARGET.Memory <span class="o">&gt;=</span> RequestMemory <span class="o">)</span> <span class="o">&amp;&amp;</span>
    <span class="o">(</span> <span class="o">(</span> TARGET.HasFileTransfer <span class="o">)</span> <span class="o">||</span> <span class="o">(</span> TARGET.FileSystemDomain <span class="o">==</span> MY.FileSystemDomain <span class="o">)</span> <span class="o">)</span>


Suggestions:
    Condition                         Machines Matched Suggestion
    <span class="nt">---------</span>                         <span class="nt">----------------</span> <span class="nt">----------</span>
1   <span class="o">(</span> target.OpSys <span class="o">==</span> <span class="s2">"OSX"</span> <span class="o">)</span>         0                MODIFY TO <span class="s2">"LINUX"</span>
2   <span class="o">(</span> TARGET.Arch <span class="o">==</span> <span class="s2">"X86_64"</span> <span class="o">)</span>       5190
3   <span class="o">(</span> TARGET.Disk <span class="o">&gt;=</span> 1 <span class="o">)</span>              5257
4   <span class="o">(</span> TARGET.Memory <span class="o">&gt;=</span> ifthenelse<span class="o">(</span>MemoryUsage isnt undefined,MemoryUsage,1<span class="o">)</span> <span class="o">)</span>
                                      5257
5   <span class="o">(</span> <span class="o">(</span> TARGET.HasFileTransfer <span class="o">)</span> <span class="o">||</span> <span class="o">(</span> TARGET.FileSystemDomain <span class="o">==</span> <span class="s2">"submit-1.chtc.wisc.edu"</span> <span class="o">)</span> <span class="o">)</span>
                                      5257
</code></pre></div></div>

<ul>
  <li>Job in the Hold State</li>
</ul>

<p>For the example job ID 16.0, use:</p>

<p>condor_q  -hold  16.0</p>

<ul>
  <li>Job Termination</li>
</ul>

<p>A ticket of execution is usually issued by the condor_startd, and includes:</p>

<ul>
  <li>
    <p>when the condor_startd was told, or otherwise decided, to terminate the job (the when attribute);</p>
  </li>
  <li>
    <p>who made the decision to terminate, usually a Sinful string (the who attribute);</p>
  </li>
  <li>
    <p>and what method was employed to command the termination, as both as string and an integer (the How and HowCode attributes).</p>
  </li>
</ul>

<p>The relevant log events include a human-readable rendition of the ToE, and the job ad is updated with the ToE after the usual delay.</p>

<p>As of version 8.9.4, HTCondor only issues ToE in three cases:</p>

<ul>
  <li>
    <p>when the job terminates of its own accord (issued by the starter, HowCode 0);</p>
  </li>
  <li>
    <p>and when the startd terminates the job because it received a DEACTIVATE_CLAIM commmand (HowCode 1)</p>
  </li>
  <li>
    <p>or a DEACTIVATE_CLAIM_FORCIBLY command (HowCode 2).</p>
  </li>
  <li>
    <p>Job Completion</p>
  </li>
</ul>

<p>When an HTCondor job completes, either through normal means or by abnormal termination by signal, HTCondor will remove it from the job queue.</p>

<p>By default, HTCondor does not send an email message when the job completes. Modify this behavior with the notification command in the submit description file. The message will include the exit status of the job, which is the argument that the job passed to the exit system call when it completed, or it will be notification that the job was killed by a signal. Notification will also include the following statistics (as appropriate) about the job:</p>

<ul>
  <li>
    <p><strong>Submitted</strong> at:</p>

    <p>when the job was submitted with condor_submit</p>
  </li>
  <li>
    <p><strong>Completed</strong> at:</p>

    <p>when the job completed</p>
  </li>
  <li>
    <p><strong>Real Time:</strong></p>

    <p>the elapsed time between when the job was submitted and when it completed, given in a form of <days> <hours>:<minutes>:<seconds></seconds></minutes></hours></days></p>
  </li>
  <li>
    <p><strong>Virtual Image Size:</strong></p>

    <p>memory size of the job, computed when the job checkpoints</p>
  </li>
</ul>

<p>The job terminated event includes the following:</p>

<ul>
  <li>
    <p>the type of termination (normal or by signal)</p>
  </li>
  <li>
    <p>the return value (or signal number)</p>
  </li>
  <li>
    <p>local and remote usage for the last (most recent) run (in CPU-seconds)</p>
  </li>
  <li>
    <p>local and remote usage summed over all runs (in CPU-seconds)</p>
  </li>
  <li>
    <p>bytes sent and received by the job’s last (most recent) run,</p>
  </li>
  <li>
    <p>bytes sent and received summed over all runs,</p>
  </li>
  <li>
    <p>a report on which partitionable resources were used, if any. Resources include CPUs, disk, and memory; all are lifetime peak values.</p>
  </li>
  <li>
    <p>Summary of all HTCondor users and their jobs</p>
  </li>
</ul>

<p>When jobs are submitted, HTCondor will attempt to find resources to run the jobs.</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_status -submitters


Name                 Machine      Running IdleJobs HeldJobs

ballard@cs.wisc.edu  bluebird.c         0       11        0
nice-user.condor@cs. cardinal.c         6      504        0
wright@cs.wisc.edu   finch.cs.w         1        1        0
jbasney@cs.wisc.edu  perdita.cs         0        0        5

                           RunningJobs           IdleJobs           HeldJobs

 ballard@cs.wisc.edu                 0                 11                  0
 jbasney@cs.wisc.edu                 0                  0                  5
nice-user.condor@cs.                 6                504                  0
  wright@cs.wisc.edu                 1                  1                  0

               Total                 7                516                  5
</code></pre></div></div>

<ul>
  <li>
    <p>Automatically managing a job</p>

    <ul>
      <li>Automatically rerunning a failed job</li>
    </ul>
  </li>
</ul>

<p>If a job exits with a non-zero exit code, this usually means that some error has happened.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example submit description with max_retries</span>

executable   <span class="o">=</span> myexe
arguments    <span class="o">=</span> SomeArgument

<span class="c"># Retry this job 5 times if non-zero exit code</span>
max_retries <span class="o">=</span> 5

output       <span class="o">=</span> outputfile
error        <span class="o">=</span> errorfile
log          <span class="o">=</span> myexe.log

request_cpus   <span class="o">=</span> 1
request_memory <span class="o">=</span> 1024
request_disk   <span class="o">=</span> 10240

should_transfer_files <span class="o">=</span> <span class="nb">yes

</span>queue
</code></pre></div></div>

<ul>
  <li>Automatically removing a job in the queue</li>
</ul>

<p>In the submit description file, set periodic_remove to a classad expression. For example, to automatically remove a job which has been in the queue for more than 100 hours, the submit file could have</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>periodic_remove <span class="o">=</span> <span class="o">(</span><span class="nb">time</span><span class="o">()</span> - QDate<span class="o">)</span> <span class="o">&gt;</span> <span class="o">(</span>100 <span class="k">*</span> 3600<span class="o">)</span>
</code></pre></div></div>

<p>or, to remove jobs that have been running for more than two hours:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>periodic_remove <span class="o">=</span> <span class="o">(</span>JobStatus <span class="o">==</span> 2<span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nb">time</span><span class="o">()</span> - EnteredCurrentStatus<span class="o">)</span> <span class="o">&gt;</span> <span class="o">(</span>2 <span class="k">*</span> 3600<span class="o">)</span>
</code></pre></div></div>

<ul>
  <li>Automatically releasing a held job</li>
</ul>

<p>In the same way that a job can be automatically held, jobs in the held state can be released with the periodic_release command. Often, using a periodic_hold with a paired periodic_release is a good way to restart a stuck job.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>periodic_hold <span class="o">=</span> <span class="o">(</span>JobStatus <span class="o">==</span> 2<span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nb">time</span><span class="o">()</span> - EnteredCurrentStatus<span class="o">)</span> <span class="o">&gt;</span> <span class="o">(</span>2 <span class="k">*</span> 3600<span class="o">)</span>
periodic_hold_reason <span class="o">=</span> <span class="s2">"Job ran for more than two hours"</span>
periodic_hold_subcode <span class="o">=</span> 42
periodic_release <span class="o">=</span> <span class="o">(</span>HoldReasonSubCode <span class="o">==</span> 42<span class="o">)</span>
</code></pre></div></div>

<ul>
  <li>Holding a completed job</li>
</ul>

<p>A job may exit, and HTCondor consider it completed, even though something has gone wrong with the job. A held job informs users that there may have been a problem with the job that should be investigated. For example, if a job should never exit by a signal, the job can be put on hold if it does with</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>on_exit_hold <span class="o">=</span> ExitBySignal <span class="o">==</span> <span class="nb">true</span>
</code></pre></div></div>
<p>Go to <a href="https://htcondor.readthedocs.io/en/latest/man-pages/index.html">Command reference manual</a></p>

<!-------------------------------------------------------------------------------------->
<!----------------------------- services for running jobs ------------------------------>

<h2 id="services"> Services for Running Jobs</h2>

<p>In general, it is preferable to just declare the minimum set of needed environment variables with the environment command, as that clearly declares the needed environment variables.</p>

<p>Commands within the submit description file may reference the environment variables of the submitter. Submit description file commands use $ENV(EnvironmentVariableName) to reference the value of an environment variable.</p>

<ul>
  <li>Extra Environment Variables HTCondor sets for Jobs</li>
</ul>

<p>Additional environment variables</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_CONDOR_SCRATCH_DIR</code> names the directory where the job may place temporary data files. This directory is unique for every job that is run, and its contents are deleted by HTCondor when the job stops running on a machine. When file transfer is enabled, the job is started in this directory.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_CONDOR_SLOT</code> gives the name of the slot (for multicore machines), on which the job is run. On machines with only a single slot, the value of this variable will be 1, just like the SlotID attribute in the machine’s ClassAd. See the Policy Configuration for Execute Hosts and for Submit Hosts section for more details about configuring multicore machines.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_CONDOR_JOB_AD</code> is the path to a file in the job’s scratch directory which contains the job ad for the currently running job. The job ad is current as of the start of the job, but is not updated during the running of the job. The job may read attributes and their values out of this file as it runs, but any changes will not be acted on in any way by HTCondor. The format is the same as the output of the condor_q -l command. This environment variable may be particularly useful in a USER_JOB_WRAPPER.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_CONDOR_MACHINE_AD</code> is the path to a file in the job’s scratch directory which contains the machine ad for the slot the currently running job is using. The machine ad is current as of the start of the job, but is not updated during the running of the job. The format is the same as the output of the condor_status -l command. Interesting attributes jobs may want to look at from this file include Memory and Cpus, the amount of memory and cpus provisioned for this slot.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_CONDOR_JOB_IWD</code> is the path to the initial working directory the job was born with.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">_CONDOR_WRAPPER_ERROR_FILE</code> is only set when the administrator has installed a USER_JOB_WRAPPER. If this file exists, HTCondor assumes that the job wrapper has failed and copies the contents of the file to the StarterLog for the administrator to debug the problem.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">CUBACORES GOMAXPROCS JULIA_NUM_THREADS MKL_NUM_THREADS NUMEXPR_NUM_THREADS OMP_NUM_THREADS OMP_THREAD_LIMIT OPENBLAS_NUM_THREADS TF_LOOP_PARALLEL_ITERATIONS TF_NUM_THREADS</code> are set to the number of cpu cores provisioned to this job. Should be at least RequestCpus, but HTCondor may match a job to a bigger slot. Jobs should not spawn more than this number of cpu-bound threads, or their performance will suffer. Many third party libraries like OpenMP obey these environment variables.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">X509_USER_PROXY</code> gives the full path to the X.509 user proxy file if one is associated with the job. Typically, a user will specify x509userproxy in the submit description file.</p>
  </li>
</ul>

<!-------------------------------------------------------------------------------------->
<!-----------------------------  ------------------------------>



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Work decomposition: prepare, create, submit, manage and examine the job</p>
</li>
    
  </ul>
</blockquote>

</article>

<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../03-atlasenv/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../05-coffea_casa/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      
<footer>
  <div class="row">
    <div class="col-md-6 copyright" align="left">
	
	Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2018–2022
	by <a href="https://carpentries.org/">The Carpentries</a>
        <br>
        Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2016–2018
	by <a href="https://software-carpentry.org">Software Carpentry Foundation</a>
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	<a href="https://github.com/eressegu/atlas-example-workflow/edit/gh-pages/_episodes/04-htcondor.md">Edit on GitHub</a>
	
	/
	<a href="https://github.com/eressegu/atlas-example-workflow/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="https://github.com/eressegu/atlas-example-workflow/">Source</a>
	/
	<a href="https://github.com/eressegu/atlas-example-workflow/blob/gh-pages/CITATION">Cite</a>
	/
	<a href="mailto:duranmcecilia@gmail.com">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
